<style>
  .log-profit {
    color: #ffd54a; /* ì´ë“ ë…¸ë‘ */
  }
  .log-loss {
    color: #ff4a4a; /* ì†í•´ ë¹¨ê°• */
  }
</style>

<script>
let money = 0, oeChoice = null, ladderChoice = null;
const cooldown = { odd:false, ladder:false, slot:false };

const symbols = ['ğŸ’','ğŸ‹','ğŸ””','ğŸ’'];
const names = ['ê¹€**','ì´**','ë°•**','ìµœ**','ì •**'];

const moneyEl = document.getElementById("money");
const logBox = document.getElementById("log");
const fakeWin = document.getElementById("fakeWin");

function enter() {
  document.getElementById("popup").remove();
}

function setMoney() {
  const v = Number(startMoney.value);
  if (v <= 0) return alert("ê¸ˆì•¡ ì…ë ¥");
  money = v;
  moneyEl.innerText = money;
  setup.style.display = "none";
  document.querySelector(".tabs").style.display = "flex";
  odd.classList.add("active");
}

function switchGame(id, el) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
}

/* === ì¿¨íƒ€ì„ (ì¹´ìš´íŠ¸ë‹¤ìš´) === */
function startCooldown(type, btn) {
  cooldown[type] = true;
  btn.disabled = true;

  let time = 5;
  const originText = btn.innerText;
  btn.innerText = `WAIT ${time}s`;

  const timer = setInterval(() => {
    time--;
    if (time > 0) {
      btn.innerText = `WAIT ${time}s`;
    } else {
      clearInterval(timer);
      cooldown[type] = false;
      btn.disabled = false;
      btn.innerText = originText;
    }
  }, 1000);
}

/* í™€ì§ */
function pickOE(v, el) {
  oeChoice = v;
  document.querySelectorAll('.choice button').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
}
function playOdd(btn) {
  if (cooldown.odd) return;
  const bet = Number(betOE.value);
  if (!oeChoice || bet <= 0 || bet > money) return alert("ë°°íŒ… ì˜¤ë¥˜");
  const beforeMoney = money;
  startCooldown("odd", btn);
  const ans = Math.random() < 0.5 ? 'í™€' : 'ì§';
  const win = oeChoice === ans;
  money += win ? bet : -bet;
  moneyEl.innerText = money;
  addLogGame("í™€ì§", ans, win ? 1 : -1, beforeMoney, money);
}

/* ì‚¬ë‹¤ë¦¬ */
for (let i = 1; i <= 5; i++) {
  const b = document.createElement("button");
  b.innerText = i;
  b.onclick = () => {
    ladderChoice = i;
    document.querySelectorAll('.ladder-pick button').forEach(x => x.classList.remove('active'));
    b.classList.add('active');
  };
  ladderPick.appendChild(b);
}

function getLadderRank() {
  const r = Math.random() * 100;
  if (r < 3) return 1;
  if (r < 15) return 2;
  if (r < 35) return 3;
  if (r < 60) return 4;
  return 5;
}

function playLadder(btn) {
  if (cooldown.ladder) return;
  const bet = Number(betL.value);
  if (!ladderChoice || bet <= 0 || bet > money) return alert("ë°°íŒ… ì˜¤ë¥˜");
  const beforeMoney = money;
  startCooldown("ladder", btn);
  const rank = getLadderRank();
  const multiMap = {1:4,2:2,3:1,4:0,5:-1};
  const multi = multiMap[rank];
  money += bet * multi;
  moneyEl.innerText = money;
  addLogGame("ì‚¬ë‹¤ë¦¬", `${rank}ë“±`, multi, beforeMoney, money);
}

/* ìŠ¬ë¡¯ */
for (let i = 0; i < 5; i++) {
  const d = document.createElement("div");
  d.className = "slot";
  d.innerText = "â”";
  slots.appendChild(d);
}

function playSlot(btn) {
  if (cooldown.slot) return;
  const bet = Number(betS.value);
  if (bet <= 0 || bet > money) return alert("ë°°íŒ… ì˜¤ë¥˜");
  const beforeMoney = money;
  startCooldown("slot", btn);

  const slotEls = document.querySelectorAll('.slot');
  slotEls.forEach(s => s.classList.add("spinning"));

  let c = 0;
  const spin = setInterval(() => {
    slotEls.forEach(s => {
      s.innerText = symbols[Math.floor(Math.random() * symbols.length)];
    });
    if (++c > 12) {
      clearInterval(spin);
      slotEls.forEach(s => s.classList.remove("spinning"));
      settleSlot(bet, beforeMoney);
    }
  }, 80);
}

function settleSlot(bet, beforeMoney) {
  const result = [...document.querySelectorAll('.slot')].map(s => s.innerText);
  const cnt = {};
  result.forEach(x => cnt[x] = (cnt[x] || 0) + 1);
  const max = Math.max(...Object.values(cnt));

  let multi = -2; // 2ê°œ ë™ì¼ â€“2ë°°
  if (max === 5) multi = 30;
  else if (max === 4) multi = 4;
  else if (max === 3) multi = 1;

  money += bet * multi;
  moneyEl.innerText = money;
  addLogGame("ìŠ¬ë¡¯", `${max}ê°œ ë™ì¼`, multi, beforeMoney, money);
}

/* === ê²Œì„ ë¡œê·¸ (ë³€ë™ ìƒ‰ìƒ ì ìš©) === */
function addLogGame(gameName, resultText, multi, beforeMoney, afterMoney) {
  const diff = afterMoney - beforeMoney;
  let diffClass = "";
  if (diff > 0) diffClass = "log-profit";
  else if (diff < 0) diffClass = "log-loss";

  const log = document.createElement("div");
  log.innerHTML = `
    ${gameName} | ${resultText} | x${multi} | 
    ${beforeMoney.toLocaleString()}P â†’
    <span class="${diffClass}">
      ${afterMoney.toLocaleString()}P
    </span>
  `;
  logBox.prepend(log);
}

/* ê°€ì§œ ë‹¹ì²¨ */
setInterval(() => {
  const name = names[Math.floor(Math.random() * names.length)];
  const amt = (Math.floor(Math.random() * 40) + 10) * 1000;
  fakeWin.innerText = `${name}ë‹˜ì´ ${amt}P íšë“`;
}, 7000);
</script>
